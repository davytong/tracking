<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>ğŸ’¸ Salary Tracker</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet"/>

<style>
@font-face {
  font-family: "KhmerOS";
  src: local("Khmer OS Siemreap");
}

body{
  background: linear-gradient(135deg,#eef2ff,#f9fafb);
  font-family:"Poppins","KhmerOS",sans-serif;
  padding:20px;
}

h1{
  text-align:center;
  font-weight:700;
  color:#1d4ed8;
  margin-bottom:20px;
}

.card{
  border-radius:20px;
  border:none;
  box-shadow:0 10px 30px rgba(0,0,0,0.08);
}

.card-header{
  border-radius:20px 20px 0 0;
  font-weight:600;
}

.fixed{
  background:#eef2ff;
  border-radius:12px;
  padding:10px;
  margin-bottom:6px;
  font-weight:500;
}

.expense{
  display:flex;
  justify-content:space-between;
  align-items:center;
  background:#f8fafc;
  border-radius:10px;
  padding:6px 10px;
  margin-bottom:5px;
  font-size:14px;
}

.over-card{
  border:2px solid #dc2626;
  background:#fee2e2;
}

.over{
  color:#dc2626;
  font-weight:700;
}

.progress{
  height:12px;
  border-radius:20px;
  margin-top:6px;
}

.food-plan{
  background:linear-gradient(135deg,#ecfeff,#f0f9ff);
  border-left:5px solid #0ea5e9;
  border-radius:14px;
  padding:10px;
  margin-top:10px;
  font-size:14px;
}

.food-plan i{
  color:#0284c7;
}

.lang-btn{
  position:fixed;
  top:15px;
  right:15px;
  z-index:99;
}

.btn-small{
  padding:0.25rem 0.5rem;
  font-size:0.8rem;
}
</style>
</head>

<body>

<button class="btn btn-outline-primary lang-btn" id="langBtn">ááŸ’á˜áŸ‚áš</button>
<h1 id="title"></h1>

<div class="container">

<div class="d-flex justify-content-between mb-3">
  <select id="monthSelect" class="form-select w-50"></select>
  <button class="btn btn-danger" id="resetMonth">
    <i class="fa fa-refresh"></i> Reset
  </button>
</div>

<div class="row" id="tracker"></div>

<div class="card mt-4">
  <div class="card-body text-center fw-bold">
    <i class="fa fa-wallet text-primary"></i>
    <span id="spentLabel"></span>: $<span id="grandSpent">0</span> |
    <span id="remainLabel"></span>: $<span id="grandRemain">0</span>
  </div>
</div>

</div>

<!-- MODAL -->
<div class="modal fade" id="expModal">
<div class="modal-dialog modal-dialog-centered">
<div class="modal-content">
<div class="modal-header">
<h5 id="modalTitle"></h5>
<button class="btn-close" data-bs-dismiss="modal"></button>
</div>
<div class="modal-body">
<input id="expName" class="form-control mb-2"/>
<input id="expCost" type="number" class="form-control"/>
</div>
<div class="modal-footer">
<button class="btn btn-danger" id="deleteBtn">
<i class="fa fa-trash"></i>
</button>
<button class="btn btn-success" id="saveBtn">
<i class="fa fa-save"></i>
</button>
</div>
</div>
</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
const SALARY=320, HALF_DAYS=15;

const i18n={
en:{
 title:"Salary Tracker",
 first:"First Half (1â€“15)",
 second:"Second Half (16â€“End)",
 spent:"Spent", remain:"Remaining",
 needRemain:"Need remain",
 needSpend:"Need spend",
 day:"days",
 items:{Food:"Food",Gas:"Gas",House:"House",Saving:"Saving",Oil:"Oil",Other:"Other"}
},
km:{
 title:"áá¶ášá¶á„á‚áŸ’ášá”áŸ‹á‚áŸ’ášá„á”áŸ’ášá¶á€áŸ‹ááŸ‚",
 first:"á–á¶á€áŸ‹á€ááŸ’áá¶á›ááŸ‚á‘á¸áŸ¡ (áŸ¡â€“áŸ¡áŸ¥)",
 second:"á–á¶á€áŸ‹á€ááŸ’áá¶á›ááŸ‚á‘á¸áŸ¢ (áŸ¡áŸ¦â€“á…á»á„ááŸ‚)",
 spent:"á…áŸ†áá¶á™", remain:"á“áŸ…áŸá›áŸ‹",
 needRemain:"ááŸ’ášá¼áœá“áŸ…áŸá›áŸ‹",
 needSpend:"ááŸ’ášá¼áœá…áŸ†áá¶á™",
 day:"ááŸ’á„áŸƒ",
 items:{Food:"á¢á¶á á¶áš",Gas:"áŸá¶áŸ†á„",House:"á•áŸ’á‘áŸ‡",Saving:"áŸá“áŸ’áŸáŸ†",Oil:"á”áŸ’ášáŸá„á˜áŸ‰á¼áá¼",Other:"á•áŸ’áŸáŸá„áŸ—"}
}
};

let lang=localStorage.getItem("lang")||"en";

const halves=[
{key:"first",fixed:["Saving"],vars:["Food","Gas","Other"]},
{key:"second",fixed:["House"],vars:["Food","Oil","Other"]}
];

const budgets={Food:60,Gas:15,House:70,Saving:60,Oil:15,Other:25};

const monthSelect=document.getElementById("monthSelect");
const y=new Date().getFullYear();
for(let m=1;m<=12;m++)monthSelect.innerHTML+=`<option>${y}-${m}</option>`;
monthSelect.value=`${y}-${new Date().getMonth()+1}`;

const key=(h,c)=>`${monthSelect.value}-${h}-${c}`;
const load=k=>JSON.parse(localStorage.getItem(k)||"[]");
const save=(k,v)=>localStorage.setItem(k,JSON.stringify(v));

let ctx=null;

function render(){
const t=i18n[lang];
title.textContent=t.title;
spentLabel.textContent=t.spent;
remainLabel.textContent=t.remain;
langBtn.textContent=lang==="en"?"ááŸ’á˜áŸ‚áš":"EN";

tracker.innerHTML="";
let grand=0;

halves.forEach(h=>{
let halfTotal=0;

const foodList=load(key(h.key,"Food"));
const foodSpent=foodList.reduce((a,b)=>a+b.cost,0);
const foodRemain=budgets.Food-foodSpent;
const daysLeft=Math.max(HALF_DAYS-foodList.length,1);
const perDay=(foodRemain/daysLeft).toFixed(2);

let html=`<div class="col-md-6 mb-3">
<div class="card">
<div class="card-header bg-primary text-white">${t[h.key]}</div>
<div class="card-body">`;

h.fixed.forEach(f=>{
if(load(key(h.key,f)).length)halfTotal+=budgets[f];
html+=`<div class="fixed">${t.items[f]} $${budgets[f]}</div>`;
});

h.vars.forEach(v=>{
let b=budgets[v];
if(v==="Other"&&h.key==="second")b-=10;
const list=load(key(h.key,v));
const s=list.reduce((a,b)=>a+b.cost,0);
const r=b-s;
halfTotal+=s;

html+=`
<div class="card p-2 mb-2 ${r<0?"over-card":""}">
<b>${t.items[v]} ($${b})</b>
${list.map(e=>`<div class="expense">${e.name} $${e.cost}</div>`).join("")}
<div class="${r<0?"over":""}">
${t.spent}: $${s} | ${t.remain}: $${r}
</div>
</div>`;
});

html+=`
<div class="food-plan">
<i class="fa fa-utensils"></i>
<b>${t.items.Food} ($60)</b><br>
${t.spent}: $${foodSpent} |
${t.remain}: $${Math.max(foodRemain,0)} |
${t.needRemain}: $${foodRemain}<br>
<i class="fa fa-calendar"></i>
${t.needSpend} ~$${perDay}/${t.day} ${daysLeft} ${t.day}
</div>

</div></div></div>`;

tracker.innerHTML+=html;
grand+=halfTotal;
});

grandSpent.textContent=grand;
grandRemain.textContent=SALARY-grand;
}

langBtn.onclick=()=>{
lang=lang==="en"?"km":"en";
localStorage.setItem("lang",lang);
render();
};

monthSelect.onchange=render;
resetMonth.onclick=()=>{localStorage.clear();render();};

render();
</script>
</body>
</html>